<!DOCTYPE html>
<html>
<head>
  <title>Dashboard - {{ user.username }}</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <header>
      <h2>Welcome, {{ user.username }}@estrogen.email</h2>
      <nav>
        <a href="/set-forwarding/{{ user.username }}" class="nav-link">⚙️ Forwarding Settings</a>
        <form action="/logout" method="post" style="display: inline;">
          <button type="submit" class="nav-link" style="background: none; border: 1px solid #8c5db9;">🚪 Logout</button>
        </form>
      </nav>
    </header>
    
    <div class="info-section">
      <h3>📧 Your Email Address</h3>
      <div class="email-address">{{ user.username }}@estrogen.email</div>
      {% if user.forwarding_address %}
        <div class="forwarding-info">
          📨 Forwarding to: <strong>{{ user.forwarding_address }}</strong>
        </div>
      {% else %}
        <div class="forwarding-info">
          ⚠️ No forwarding address set. <a href="/set-forwarding/{{ user.username }}">Set one now</a>
        </div>
      {% endif %}
    </div>

    <div class="emails-section">
      <h3>📬 Your Emails ({{ emails|length }})</h3>
      {% for email in emails %}
        <div class="email-box">
          <div class="email-header">
            <div class="email-from"><strong>From:</strong> {{ email.from_address }}</div>
            <div class="email-actions">
              <span class="email-date">{{ email.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
              <form action="/delete-email/{{ email.id }}" method="post" style="display: inline; margin-left: 10px;">
                <button type="submit" class="delete-btn" onclick="return confirm('Delete this email?')">🗑️</button>
              </form>
            </div>
          </div>
          <div class="email-subject"><strong>Subject:</strong> {{ email.subject or '(No Subject)' }}</div>
          <div class="email-body">
            <pre>{{ email.body or '(Empty message)' }}</pre>
          </div>
        </div>
      {% else %}
        <div class="empty-state">
          <p>📭 No emails yet. Your address is <strong>{{ user.username }}@estrogen.email</strong></p>
          <p>Send a test email to see it appear here!</p>
        </div>
      {% endfor %}
    </div>
  </div>
</body>
</html>
